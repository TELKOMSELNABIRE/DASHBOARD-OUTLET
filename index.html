<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Outlet</title>

<style>
body{font-family:Poppins,Arial;background:#f4f6f8;margin:0}
header{background:#b51217;color:#fff;padding:16px;text-align:center}
nav{display:flex;justify-content:center;gap:10px;margin:20px}
nav button{padding:10px 18px;border:none;border-radius:8px;font-weight:600;cursor:pointer}
nav button.active{background:#b51217;color:#fff}
.container{max-width:1200px;margin:auto;padding:20px}
table{width:100%;border-collapse:collapse;background:#fff}
th,td{padding:10px;border-bottom:1px solid #eee}
th{background:#f0f0f0}
</style>
</head>

<body>

<header><h2>Dashboard Outlet</h2></header>

<nav>
<button class="active" onclick="loadSheet('TRASSER',this)">TRASSER</button>
<button onclick="loadSheet('TRAGIS',this)">TRAGIS</button>
<button onclick="loadSheet('TRAVO',this)">TRAVO</button>
</nav>

<div class="container">
<table>
<thead>
<tr>
<th>Outlet ID</th>
<th>Nama Outlet</th>
<th>Rev Jan'25</th>
<th>Rev Jan'26</th>
<th>YoY</th>
<th>Eligible</th>
<th>Score</th>
<th>Rank</th>
</tr>
</thead>
<tbody id="data">
<tr><td colspan="8">Loading...</td></tr>
</tbody>
</table>
</div>

<script>
const BASE =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vSU1jMmoHiOKZ4imo91F5h9XdcykRG3CbqEQNthOXeVIOh1vsb51khLRXUdJBBfIKKgD3SKb-o2IDHQ/gviz/tq?tqx=out:json&sheet=";

function loadSheet(sheet,btn){
document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");

fetch(BASE+sheet)
.then(r=>r.text())
.then(t=>{
const json=JSON.parse(t.substring(47,t.length-2));
const rows=json.table.rows;
const tbody=document.getElementById("data");
tbody.innerHTML="";

rows.forEach(r=>{
tbody.innerHTML+=`
<tr>
<td>${r.c[0]?.v||""}</td>
<td>${r.c[2]?.v||""}</td>
<td>${r.c[4]?.f||r.c[4]?.v||""}</td>
<td>${r.c[6]?.f||r.c[6]?.v||""}</td>
<td>${r.c[7]?.f||r.c[7]?.v||""}</td>
<td>${r.c[9]?.v||""}</td>
<td>${r.c[10]?.v||""}</td>
<td>${r.c[11]?.v||""}</td>
</tr>`;
});
})
.catch(()=>{
document.getElementById("data").innerHTML=
"<tr><td colspan='8'>Gagal memuat data</td></tr>";
});
}

loadSheet("TRASSER",document.querySelector("nav button"));
</script>

</body>
</html>
